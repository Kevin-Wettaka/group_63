BRANCH 4 MERGED WITH BRANCH 3